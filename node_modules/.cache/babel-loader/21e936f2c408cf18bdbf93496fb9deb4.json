{"ast":null,"code":"import _regeneratorRuntime from\"/Users/modulewrapper/Desktop/Sanchay/StudyMode/Web Dev/WebPractice/BolChal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/modulewrapper/Desktop/Sanchay/StudyMode/Web Dev/WebPractice/BolChal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useRef,useState,useEffect}from'react';import{useHistory}from'react-router-dom';import{ChatEngine}from'react-chat-engine';import{auth}from'../firebase';import{useAuth}from'../contexts/AuthContext';import axios from'axios';var Chats=function Chats(){var history=useHistory();var _useAuth=useAuth(),user=_useAuth.user;var _useState=useState(true),loading=_useState.loading,setLoading=_useState.setLoading;var handleLogout=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return auth.signOut();case 2:history.push('/');case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleLogout(){return _ref.apply(this,arguments);};}();var getFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url);case 2:response=_context2.sent;_context2.next=5;return response.blob();case 5:data=_context2.sent;return _context2.abrupt(\"return\",new File([data],\"userPhoto.jpg\",{type:'image/jpeg'}));case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getFile(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(!user){history.push('/');return;}axios.get('https://api.chatengine.io/users/me',{headers:{\"project\":process.env.REACT_APP_CHAT_ENGINE_ID,\"user-name\":user.email,\"user-secret\":user.uid}}).then(function(){setLoading(false);}).catch(function(){var formdata=new FormData();formdata.append('email',user.email);formdata.append('username',user.email);formdata.append('secret',user.uid);getFile(user.photoURL).then(function(avatar){formdata.append('avatar',avatar,avatar.name);axios.post('https://api.chatengine.io/users/',formdata,{headers:{\"private-key\":process.env.REACT_APP_CHAT_ENGINE_KEY}}).then(function(){return setLoading(false);}).catch(function(error){return console.log(error);});});});},[user,history]);if(!user||loading)return'Loading...';return/*#__PURE__*/React.createElement(\"div\",{className:\"chats-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nav-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo-tab\"},\"Baat\\u091A\\u0940\\u0924 \\uD83D\\uDCAC : Free Chat Rooms\"),/*#__PURE__*/React.createElement(\"div\",{onClick:handleLogout,className:\"logout-tab\"},\"Log\\u0906\\u0909\\u091F!\")),/*#__PURE__*/React.createElement(ChatEngine,{height:\"calc(100vh - 66px)\",projectID:process.env.REACT_APP_CHAT_ENGINE_ID,userName:user.email,userSecret:user.uid}));};export default Chats;","map":{"version":3,"sources":["/Users/modulewrapper/Desktop/Sanchay/StudyMode/Web Dev/WebPractice/BolChal/src/components/Chats.js"],"names":["React","useRef","useState","useEffect","useHistory","ChatEngine","auth","useAuth","axios","Chats","history","user","loading","setLoading","handleLogout","signOut","push","getFile","url","fetch","response","blob","data","File","type","get","headers","process","env","REACT_APP_CHAT_ENGINE_ID","email","uid","then","catch","formdata","FormData","append","photoURL","avatar","name","post","REACT_APP_CHAT_ENGINE_KEY","error","console","log"],"mappings":"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","sourcesContent":["import React,{useRef,useState,useEffect} from 'react'\nimport {useHistory} from 'react-router-dom';\nimport {ChatEngine} from 'react-chat-engine';\nimport {auth} from '../firebase';\n\nimport {useAuth} from '../contexts/AuthContext';\nimport axios from 'axios';\n\nconst Chats = () => {\n\n    const history = useHistory();\n    const { user } = useAuth();\n    const {loading,setLoading} = useState(true);\n\n    const handleLogout = async () => {\n        await auth.signOut();\n        history.push('/');\n    }\n\n    const getFile = async (url) =>{\n        const response = await fetch(url);\n        const data = await response.blob();\n\n        return new File([data],\"userPhoto.jpg\",{type:'image/jpeg'})\n    }\n\n    useEffect(()=>{\n        if(!user){\n            history.push('/');\n            return;\n        }\n\n        axios.get('https://api.chatengine.io/users/me',{\n            headers:{\n                \"project\":process.env.REACT_APP_CHAT_ENGINE_ID,\n                \"user-name\": user.email,\n                \"user-secret\" : user.uid,\n            }\n        })\n        .then(()=>{\n            setLoading(false);\n        })\n        .catch(()=>{\n            let formdata = new FormData();\n            formdata.append('email',user.email);\n            formdata.append('username',user.email);\n            formdata.append('secret',user.uid);\n\n            getFile(user.photoURL)\n                .then((avatar)=>{\n                    formdata.append('avatar',avatar,avatar.name);\n                    axios.post('https://api.chatengine.io/users/',\n                        formdata,\n                        {headers : {\"private-key\" : process.env.REACT_APP_CHAT_ENGINE_KEY}}\n                    )\n                    .then(()=>setLoading(false))\n                    .catch((error) => console.log(error))\n                })\n        })\n\n    },[user,history]);\n\n    if(!user  || loading) return 'Loading...';\n\n    return (\n        <div className = \"chats-page\">\n            <div className = \"nav-bar\">\n                <div className=\"logo-tab\">\n                Baatà¤šà¥€à¤¤ ðŸ’¬ : Free Chat Rooms\n                </div>\n                <div onClick ={handleLogout} className=\"logout-tab\">\n                    Logà¤†à¤‰à¤Ÿ!\n                </div>\n            </div>\n\n            <ChatEngine\n                height=\"calc(100vh - 66px)\"\n                projectID = {process.env.REACT_APP_CHAT_ENGINE_ID}\n                userName = {user.email}\n                userSecret = {user.uid}\n            />\n        </div>\n    )\n}\n\nexport default Chats\n"]},"metadata":{},"sourceType":"module"}